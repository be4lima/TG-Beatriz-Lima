[["modelos-lineares.html", "Capítulo 3 Modelos lineares 3.1 Covariância 3.2 Correlação 3.3 Regressão linear simples Aplicação", " Capítulo 3 Modelos lineares Resumidamente, modelos lineares são utilizados para resumir relações observadas a partir de dados, no caso, ambientais, em uma linha reta. Em um modelo linear descreve-se o comportamento de uma variável dependente (ou variável resposta, y) como função de uma ou mais variáveis independentes (ou variáveis explicativas, x). 3.1 Covariância A Covariância, denotada \\(\\sigma_{xy}\\), descreve a variação, em relação a média, entre duas variáveis. \\(cov(x,y) = \\frac{\\sum(x_i - \\overline{x})}{n-1}\\) Portanto, é possível saber se ambas variáveis desviam na mesma direção (covariância positiva) ou se desviam em direções opostas (covariância negativa). Caso a covariância entre duas variáveis seja zero, a conclusão é que as variáveis são independentes. knitr::include_graphics(&quot;~/UFABC Beatriz/TG Beatriz Lima/Dados/Figuras/Covariancia.png&quot;) (#fig:fig-3.1)Covariância 3.2 Correlação A Correlação é útil para medir a relação linear entre duas variáveis x e y, denotada por \\(\\rho_{xy}\\). \\(\\rho_xy = \\frac{cov(x,Y)}{\\sqrt(V(x)V(Y))}\\) Sendo assim, duas variáveis podem estar relacionadas das seguintes formas: Positivamente relacionadas. Ou seja, se x aumenta, y aumenta. E o mesmo ocorre para caso X diminua (Y diminui) - Correlação positiva; Negativamente relacionadas. Ou seja, se x aumenta, y diminui. E o mesmo ocorre para caso x diminua (Y aumenta) - Correlação negativa; Não há relação entre as duas variáveis. knitr::include_graphics(&quot;~/UFABC Beatriz/TG Beatriz Lima/Dados/Figuras/Correlação.jpg&quot;) (#fig:fig-3.2)Correlação Uma forma gráfica de visualizar a correlação das variáveis que apresenta grande utilidade é a partir do Diagrama de Dispersão. O diagrama traz informações importantes porque mostra se a relação entre as variáveis é linear ou não, se existem outliers no conjunto de dados e traz uma ideia de quão forte é o relacionamento entre as variáveis. 3.3 Regressão linear simples A partir da regressão, é possível obter a relação matemática que descreva a relação entre duas ou mais variáveis. A análise de regressão é uma coleção de ferramentas estatísticas que permite a modelagem e inferência de uma variável dependente (y) com uma ou mais variáveis independentes (x). No caso da regressão linear simples, somente existe uma variável independente; para a regressão linear múltipla, mais de uma. Dessa forma, o formato básico do modelo de regressão linear é: \\(Y = \\beta_0 + \\beta_1X_1\\), sendo \\(\\beta_0\\) o coeficiente do intercepto e \\(\\beta_1\\) o coeficiente de inclinação De acordo com Montgomery &amp; Runger (2021), o modelo de regressão é, na verdade, uma linha de valores médios. Ou seja, a altura da linha de regressão em qualquer valor de x é apenas o valor esperado de Y para aquele x. O coeficiente angular, \\(\\beta_1\\), pode ser interpretado como a mudança na média de Y para uma mudança unitária em x. Além disso, a variabilidade de Y, em um valor particular de x, é determinada pela variância do erro \\(\\sigma^2\\). Portanto, há uma distribuição de valores de Y em cada x de forma que a variância da distribuição é constante em cada x. 3.3.1 Condições São assumidas algumas hipóteses sobre os dados de entrada na Regressão Linear: Linearidade: a relação entre X e Y deve ser linear; Homocedasticidade: a variância da variável dependente (Y) deve ser constante para todos os valores das variáveis independentes (X); Normalidade: para um valor fixo de X, Y é uma variável aleatória com distribuição normal. Os resíduos também devem ser normalmente distribuídos; Independência dos resíduo: como Yi e Yj são valores estatisticamente independentes (falta de correlação), os resíduos também deverão ser independentes. Ausência de outliers influentes: não devem existir outliers que influenciem consideravelmente o modelo; Aplicação Para a aplicação serão utilizados dados de emissões dos gases de efeito estufa (GEE) por mudanças de cobertura da terra da Amazônia Legal disponibilizados pelo INPE (Instituto Nacional de Pesquisas Espaciais). Será representada a relação entre a área desmatada por ano e a emissão de 1ª ordem de \\(CO_2\\) na Amazônia Legal.A estimativa de 1ª ordem supõe que, de modo simplificado, 100% das emissões ocorreram no momento da mudança de uso/cobertura. Um primeiro passo será carregar os dados: options(&quot;install.lock&quot;=FALSE) ## Carregar pacotes que serão usados ## Checando repositório setwd(&quot;C:/Users/Luiz Arthur/Dropbox/PC/Documents/UFABC Beatriz/TG Beatriz Lima/Dados&quot;) ## Carregando base de dados dados &lt;- read.csv2(&quot;CO2Amazonia.csv&quot;) View(dados) data_size= dim(dados) Agora que os dados foram carregados, o segundo passo será entender os dados. Para saber algumas propriedade dos dados carregados, será utilizado o comando head()`, que apresentará uma amostra dos dados, esummary()`, que apresenta as estatísticas básicas dos dados (média, mediana, 1º quartil, etc). head(dados) ## Year D_AreaAcc D_Area DEGRAD_Area X. VR_CO2_1stOrder VR_CO2_2ndOrder ## 1 1960 842754 842754 0 - 411 133 ## 2 1961 1685508 842754 0 - 411 222 ## 3 1962 2528262 842754 0 - 411 276 ## 4 1963 3371016 842754 0 - 411 311 ## 5 1964 4213770 842754 0 - 411 334 ## 6 1965 5056524 842754 0 - 411 350 ## SV_CO2Emission SV_CO2Absorption X..1 DEGRAD_CO2Emission DEGRAD_CO2Absorption ## 1 0 0 - 0 0 ## 2 0 0 - 0 0 ## 3 0 0 - 0 0 ## 4 0 -2 - 0 0 ## 5 0 -4 - 0 0 ## 6 0 -7 - 0 0 ## X..2 NET_1st_Order NET_2nd_Order ## 1 - 411 133 ## 2 - 411 222 ## 3 - 411 276 ## 4 - 409 309 ## 5 - 407 329 ## 6 - 404 342 summary(dados) ## Year D_AreaAcc D_Area DEGRAD_Area ## Min. :1960 Min. : 842754 Min. : 457100 Min. : 0 ## 1st Qu.:1975 1st Qu.:13484064 1st Qu.: 842754 1st Qu.: 0 ## Median :1990 Median :40302326 Median :1103000 Median : 155872 ## Mean :1990 Mean :37464148 Mean :1324505 Mean : 403505 ## 3rd Qu.:2005 3rd Qu.:61076244 3rd Qu.:1822600 3rd Qu.: 155872 ## Max. :2020 Max. :69723152 Max. :2905900 Max. :2741165 ## X. VR_CO2_1stOrder VR_CO2_2ndOrder SV_CO2Emission ## Length:61 Min. : 234.0 Min. : 133.0 Min. : 0.0 ## Class :character 1st Qu.: 411.0 1st Qu.: 381.0 1st Qu.: 7.0 ## Mode :character Median : 541.0 Median : 603.0 Median : 39.0 ## Mean : 653.6 Mean : 616.2 Mean : 48.7 ## 3rd Qu.: 888.0 3rd Qu.: 844.0 3rd Qu.: 83.0 ## Max. :1416.0 Max. :1107.0 Max. :138.0 ## SV_CO2Absorption X..1 DEGRAD_CO2Emission DEGRAD_CO2Absorption ## Min. :-185.00 Length:61 Min. : 0.00 Min. :-245.00 ## 1st Qu.:-143.00 Class :character 1st Qu.: 0.00 1st Qu.: -31.00 ## Median : -81.00 Mode :character Median : 34.00 Median : -18.00 ## Mean : -86.03 Mean : 81.52 Mean : -54.59 ## 3rd Qu.: -28.00 3rd Qu.: 34.00 3rd Qu.: 0.00 ## Max. : 0.00 Max. :691.00 Max. : 0.00 ## X..2 NET_1st_Order NET_2nd_Order ## Length:61 Min. : 108.0 Min. : 133.0 ## Class :character 1st Qu.: 396.0 1st Qu.: 366.0 ## Mode :character Median : 550.0 Median : 667.0 ## Mean : 643.2 Mean : 605.7 ## 3rd Qu.: 880.0 3rd Qu.: 853.0 ## Max. :1380.0 Max. :1053.0 Como iremos analisar a relação entre a área desmatada por ano (D_Area) e a emissão de 1ª ordem de \\(CO_2\\), é importante verificar qual é o comportamento entre esses dados. ## Verificando a relação entre a variável dependente e a variável independente plot(dados$D_Area, dados$VR_CO2_1stOrder) ## Correlação entre as variáveis da base de dados cor(dados$VR_CO2_1stOrder,dados$D_Area) ## [1] 0.9987358 A partir desse gráfico, é possível verificar que a relação entre as variáveis é linear e, dessa forma, conforme a área desmatada aumenta, a emissão de \\(CO_2\\) aumenta linearmente. D ## Construção do modelo mod &lt;- lm(VR_CO2_1stOrder ~ D_Area, dados, na.action = na.exclude) summary(mod) ## ## Call: ## lm(formula = VR_CO2_1stOrder ~ D_Area, data = dados, na.action = na.exclude) ## ## Residuals: ## Min 1Q Median 3Q Max ## -12.178 -12.178 -3.886 1.503 46.689 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.005e+01 4.593e+00 4.364 5.21e-05 *** ## D_Area 4.783e-04 3.134e-06 152.615 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 15.35 on 59 degrees of freedom ## Multiple R-squared: 0.9975, Adjusted R-squared: 0.9974 ## F-statistic: 2.329e+04 on 1 and 59 DF, p-value: &lt; 2.2e-16 O r² (coeficiente de determinação) do modelo é 0,9975 e, portanto, pode-se interpretar que a variável área explica 99,75% da variação na emissão de \\(CO_2\\).Dessa forma, conclui-se que o modelo possui bom ajuste. O p-value do modelo apresenta valor \\(2.2e^{-16}\\) e, assim, apresenta valor menor que o nível de significância (0,05), mostrando que existe alta probabilidade dos resultados apresentados pelo medelo não possuírem erro amostral. De acordo com Montgomery e Runger (2021), A análise dos resíduos é frequentemente útil na verificação da suposição de que os erros sejam distribuídos de forma aproximadamente normal, com variância constante, assim como na determinação da utilidade dos termos adicionais no modelo. Dessa forma, abaixo será realizada a análise residual. # Análise dos resíduos par(mfrow=c(2,2)) plot(mod) ## Gráfico de regressão linear Para a análise residual, é necessário investigar se os resíduos refletem as propriedades impostas pelo erro do modelo. Residuals vs Fitted O gráfico mostra a relação entre os resíduos e os valores ajustados, ou seja, é possível verificar se resíduos tem padrões não-lineares. A distribuição dos resíduos próxima à linha pontilhada demonsta um bom ajuste do modelo. Normal Q-Q O gráfico mostra se os resíduos são normalmente distribuídos. Mais uma vez, o ideal é que a distribuição dos resíduos acompanhe a linha pontilhada. Scale-Location O gráfico mostra se os resíduos são igualmente distribuídos em relação ao intervalo de preditores (Fitted values).Também é possível checar a homocedasticidade. O ideal, no caso, seria que os resíduos estivessem uniformemente distribuídos ao redor da linha vermelha. Residuals vs Leverage O gráfico ajuda na visualização de possíveis casos influentes, ou seja, outliers que influenciam na análise de regressão linear. O que quer dizer que, sem o outlier, o resultado da regressão seria diferente. Por fim, o resultado do modelo de regressão linear simples pode ser visualizado abaixo. #Diagrama de dispersão com o ajuste plot(x = dados$D_Area, y = dados$VR_CO2_1stOrder, xlab = &quot;Área desmatada no ano&quot;, ylab = &quot;Emissão de CO2 de 1a ordem&quot;) abline(mod, col = &quot;blue&quot;) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
